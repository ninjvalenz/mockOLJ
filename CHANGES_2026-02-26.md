Date: February 26, 2026
Project: Centralized Property Management Database
Session: Schema v5 — Pipeline Alignment Review

What I did today:
Reviewed Jan Marc's hostaway-data-hub pipeline (github.com/janmaaarc/hostaway-data-hub) against the current v4 database schema to check for any fields his code captures that we weren't storing. Found 26 missing columns across 7 tables — data the pipeline was pulling from Hostaway but that would have been silently dropped on import. Wrote migrate_v5.sql to add all of them and updated schema.sql so fresh builds match. All changes are additive (no existing data touched).

Gaps found and fixed:

- Listings — added average star rating, currency, time zone, room type, property category, and photo URLs. These were all coming through the API but had no column to land in.
- Conversations — added the property reference, a privacy-safe guest label, last-message timestamp, and the stay dates that Hostaway attaches to each conversation thread.
- Messages — added delivery status, send/receive direction flag, and the raw sender name (separate from the existing sender type category).
- Calendar — added maximum stay per date, closed-on-arrival flag, and closed-on-departure flag. The pipeline was capturing all three; the schema only had minimum stay.
- Financial reports — added total guest charge, host payout, channel commission, and payment status. These are the four financial fields the pipeline pulls that weren't in the existing breakdown columns.
- Reviews — added the booking channel, private host-only feedback, stay dates from the review record, and the raw rating score alongside the existing computed average.
- Webhooks — added the last-updated timestamp Jan Marc's pipeline captures from the API.

Files changed:
- migrate_v5.sql (new) — run this once against the live database to apply all changes
- schema.sql — updated in place so the v5 columns are included for any fresh builds going forward

What it means for the team:
When Jan Marc's pipeline loads data into the database, nothing gets dropped. Every field his code captures now has a place to go. The financial and review data in particular fills in detail that was missing from the reporting side — host payout vs. total charge vs. commission are now all stored separately so they can be queried independently. The calendar flags (closed on arrival/departure) matter for availability logic. Ready to load.

To apply:
sqlite3 property_data.db < migrate_v5.sql

Verify with: PRAGMA user_version;  — should return 5
